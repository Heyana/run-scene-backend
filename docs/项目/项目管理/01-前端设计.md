# 项目管理系统 - 前端设计

## 概述

在现有材质库系统基础上，新增项目管理功能，支持前端项目的上传、版本管理和历史回溯。

## 路由配置

### 新增路由

```typescript
{
  path: "/projects",
  name: "Projects",
  component: () => import("@/views/Projects")
}
```

## 页面结构

### Projects.tsx

主页面组件，包含项目列表和操作功能

#### 核心功能模块

```typescript
interface ProjectManagementView {
  // 项目列表展示
  renderProjectList(): JSX.Element;

  // 新建项目对话框
  renderCreateDialog(): JSX.Element;

  // 上传版本对话框
  renderUploadDialog(): JSX.Element;

  // 版本历史对话框
  renderVersionHistory(): JSX.Element;
}
```

## 组件设计

### ProjectCard.tsx

项目卡片组件

```typescript
interface ProjectCardProps {
  project: Project;
  onUploadVersion: (projectId: number) => void;
  onViewHistory: (projectId: number) => void;
  onDelete: (projectId: number) => void;
}

class ProjectCard {
  // 显示项目基本信息
  renderInfo(): JSX.Element;

  // 显示当前版本号
  renderVersion(): JSX.Element;

  // 操作按钮组
  renderActions(): JSX.Element;
}
```

### CreateProjectDialog.tsx

新建项目对话框

```typescript
interface CreateProjectForm {
  name: string; // 项目名称
  description: string; // 项目描述
  initialVersion: string; // 初始版本号（默认1.0.0）
}

class CreateProjectDialog {
  // 表单验证
  validateForm(form: CreateProjectForm): boolean;

  // 提交创建
  handleSubmit(form: CreateProjectForm): Promise<void>;
}
```

### UploadVersionDialog.tsx

上传版本对话框

```typescript
interface UploadVersionForm {
  projectId: number;
  folderPath: string; // 选择的文件夹路径
  username: string; // 上传用户名
  description: string; // 更新描述
  versionType: "major" | "minor" | "patch"; // 版本类型
}

class UploadVersionDialog {
  // 文件夹选择器
  renderFolderSelector(): JSX.Element;

  // 版本号预览（自动计算）
  renderVersionPreview(currentVersion: string, type: string): JSX.Element;

  // 表单验证
  validateForm(form: UploadVersionForm): boolean;

  // 上传处理
  handleUpload(form: UploadVersionForm): Promise<void>;
}
```

### VersionHistoryDialog.tsx

版本历史对话框

```typescript
interface VersionHistoryProps {
  projectId: number;
}

class VersionHistoryDialog {
  // 版本列表展示
  renderVersionList(versions: ProjectVersion[]): JSX.Element;

  // 版本详情
  renderVersionDetail(version: ProjectVersion): JSX.Element;

  // 回滚操作
  handleRollback(versionId: number): Promise<void>;

  // 下载版本
  handleDownload(versionId: number): void;
}
```

## 数据类型

### Project

```typescript
interface Project {
  id: number;
  name: string;
  description: string;
  currentVersion: string;
  latestVersionId: number;
  createdAt: string;
  updatedAt: string;
}
```

### ProjectVersion

```typescript
interface ProjectVersion {
  id: number;
  projectId: number;
  version: string;
  username: string;
  description: string;
  filePath: string;
  fileSize: number;
  createdAt: string;
}
```

## API接口调用

### api/projects.ts

```typescript
class ProjectAPI {
  // 获取项目列表
  getProjects(params: QueryParams): Promise<ProjectListResponse>;

  // 创建项目
  createProject(data: CreateProjectForm): Promise<Project>;

  // 上传版本
  uploadVersion(data: FormData): Promise<ProjectVersion>;

  // 获取版本历史
  getVersionHistory(projectId: number): Promise<ProjectVersion[]>;

  // 删除项目
  deleteProject(projectId: number): Promise<void>;

  // 下载版本
  downloadVersion(versionId: number): string;
}
```

## 状态管理

### stores/project.ts

```typescript
interface ProjectStore {
  projects: Project[];
  currentProject: Project | null;
  versions: ProjectVersion[];
  loading: boolean;

  // Actions
  fetchProjects(): Promise<void>;
  createProject(data: CreateProjectForm): Promise<void>;
  uploadVersion(data: UploadVersionForm): Promise<void>;
  fetchVersionHistory(projectId: number): Promise<void>;
  deleteProject(projectId: number): Promise<void>;
}
```

## 文件夹选择实现

使用HTML5 File API的webkitdirectory属性：

```typescript
// 文件夹选择input
<input
  type="file"
  webkitdirectory
  directory
  multiple
  onChange={handleFolderSelect}
  style={{ display: 'none' }}
  ref={folderInputRef}
/>

// 处理文件夹选择
const handleFolderSelect = (e: Event) => {
  const files = (e.target as HTMLInputElement).files
  if (files && files.length > 0) {
    const folderPath = files[0].webkitRelativePath.split('/')[0]
    // 处理文件上传
  }
}
```

## 版本号自动递增规则

- Major（主版本）：1.0.0 -> 2.0.0
- Minor（次版本）：1.0.0 -> 1.1.0
- Patch（补丁版本）：1.0.0 -> 1.0.1

## UI交互流程

### 新建项目流程

1. 点击"新建项目"按钮
2. 弹出对话框，填写项目名称、描述
3. 提交后创建项目，初始版本为1.0.0

### 上传版本流程

1. 在项目卡片点击"上传版本"
2. 弹出对话框
3. 选择文件夹（前端项目目录）
4. 填写用户名和更新描述
5. 选择版本类型（major/minor/patch）
6. 系统自动计算新版本号并显示预览
7. 确认上传，后端处理文件并保存

### 查看历史流程

1. 在项目卡片点击"版本历史"
2. 弹出对话框显示所有版本列表
3. 可查看每个版本的详细信息
4. 支持下载历史版本
5. 支持回滚到指定版本

## 样式设计

### 布局

- 使用Grid布局展示项目卡片
- 响应式设计，支持不同屏幕尺寸
- 卡片悬停效果

### 主题

- 继承现有系统的主题配置
- 支持深色/浅色模式切换

## 错误处理

- 文件夹选择失败提示
- 上传失败重试机制
- 网络错误友好提示
- 表单验证错误提示
