# 需求管理平台 - 数据模型

## 数据库表设计

### 1. companies (公司/组织)

```
id: uint (主键)
name: string (公司名称)
logo: string (Logo URL)
description: string (描述)
owner_id: uint (创建人ID)
status: enum (active/archived)
created_at: datetime
updated_at: datetime
```

### 2. company_members (公司成员)

```
id: uint
company_id: uint (外键)
user_id: uint (外键)
role: enum (admin/member/viewer)
joined_at: datetime
```

### 3. projects (项目)

```
id: uint
company_id: uint (外键)
name: string (项目名称)
key: string (项目标识，如 PRJ)
description: string
owner_id: uint (负责人ID)
status: enum (active/archived)
start_date: date
end_date: date
created_at: datetime
updated_at: datetime
```

### 4. project_members (项目成员)

```
id: uint
project_id: uint (外键)
user_id: uint (外键)
role: enum (admin/developer/viewer)
joined_at: datetime
```

### 5. mission_lists (需求列表/迭代)

```
id: uint
project_id: uint (外键)
name: string (列表名称，如 Sprint 1)
type: enum (sprint/version/module)
description: string
start_date: date
end_date: date
status: enum (planning/active/completed)
sort_order: int
created_at: datetime
updated_at: datetime
```

### 6. missions (需求/任务)

```
id: uint
mission_list_id: uint (外键)
project_id: uint (外键，冗余便于查询)
title: string (需求标题)
description: text (需求描述，富文本)
type: enum (feature/enhancement/bug)
priority: enum (P0/P1/P2/P3)
status: enum (todo/in_progress/done/closed)
assignee_id: uint (负责人ID)
reporter_id: uint (创建人ID)
estimated_hours: float (预估工时)
actual_hours: float (实际工时)
start_date: date
due_date: date
completed_at: datetime
sort_order: int
created_at: datetime
updated_at: datetime
```

### 7. mission_comments (需求评论)

```
id: uint
mission_id: uint (外键)
user_id: uint (外键)
content: text
parent_id: uint (父评论ID，支持回复)
created_at: datetime
updated_at: datetime
```

### 8. mission_attachments (需求附件)

```
id: uint
mission_id: uint (外键)
file_name: string
file_url: string
file_size: int
file_type: string
uploaded_by: uint (上传人ID)
created_at: datetime
```

### 9. mission_relations (需求关联)

```
id: uint
source_mission_id: uint (源需求ID)
target_mission_id: uint (目标需求ID)
relation_type: enum (depends_on/blocks/relates_to)
created_at: datetime
```

### 10. mission_logs (需求操作日志)

```
id: uint
mission_id: uint (外键)
user_id: uint (操作人ID)
action: string (操作类型)
field: string (字段名)
old_value: string
new_value: string
created_at: datetime
```

## 关系说明

- Company 1:N Project
- Company 1:N CompanyMember
- Project 1:N ProjectMember
- Project 1:N MissionList
- MissionList 1:N Mission
- Mission 1:N Comment
- Mission 1:N Attachment
- Mission N:N Mission (通过 mission_relations)
- Mission 1:N MissionLog

## 索引建议

```
companies: owner_id, status
projects: company_id, owner_id, status
mission_lists: project_id, status
missions: mission_list_id, project_id, assignee_id, status, priority
mission_comments: mission_id, user_id
mission_attachments: mission_id
mission_relations: source_mission_id, target_mission_id
mission_logs: mission_id, created_at
```
