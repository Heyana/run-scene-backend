# 项目管理系统 - 快速开始

## 🚀 启动服务

### 后端启动

```bash
cd run-scene-backend
go run -tags dev .
```

服务将在 `http://localhost:23359` 启动

### 前端启动

```bash
cd run-scene-backend/frontend
yarn dev
```

前端将在 `http://localhost:5173` 启动

## 📝 使用步骤

### 1. 访问项目管理页面

打开浏览器访问：`http://localhost:5173/#/projects`

或在左侧菜单点击"项目管理"

### 2. 创建新项目

1. 点击"新建项目"按钮
2. 填写项目名称（必填）
3. 填写项目描述（可选）
4. 点击确定

项目创建后，初始版本为 `1.0.0`

### 3. 上传前端项目

1. 在项目列表中找到你的项目
2. 点击"上传版本"按钮
3. 选择版本类型：
   - **主版本 (major)**: 1.0.0 → 2.0.0
   - **次版本 (minor)**: 1.0.0 → 1.1.0
   - **补丁版本 (patch)**: 1.0.0 → 1.0.1
4. 填写上传用户名（必填）
5. 填写更新描述（可选）
6. 点击"选择项目文件夹"，选择你的前端项目目录
7. 确认上传

### 4. 预览网页 ⭐

1. 点击"版本历史"按钮
2. 在版本列表中找到要预览的版本
3. 点击"预览"按钮
4. 系统会在新标签页打开项目的 `index.html`

### 5. 版本管理

- **下载版本**: 点击"下载"按钮下载压缩包
- **回滚版本**: 点击"回滚"按钮将项目回滚到该版本
- **查看历史**: 查看所有版本的详细信息

## 📂 项目结构要求

上传的前端项目必须包含 `index.html` 文件才能正常预览。

推荐的项目结构：

```
your-project/
├── index.html          # 必需：入口文件
├── css/
│   └── style.css
├── js/
│   └── main.js
├── assets/
│   └── images/
└── ...
```

## 🔧 配置说明

### 存储配置

项目文件默认存储在 NAS：

```
\\192.168.3.10\project\editor_v2\static\projects
```

可以在 `configs/project_config.yaml` 中修改：

```yaml
project:
  nas_enabled: true
  nas_path: "你的NAS路径"
  base_url: "http://你的IP:23359/projects"
```

### 文件大小限制

- 单个文件最大: 500MB
- 项目总大小最大: 1GB

可在配置文件中调整：

```yaml
project:
  max_file_size: 524288000 # 500MB
  max_project_size: 1073741824 # 1GB
```

## 🎯 API接口

### 获取项目列表

```
GET /api/projects?page=1&page_size=20&keyword=搜索关键词
```

### 创建项目

```
POST /api/projects
Content-Type: application/json

{
  "name": "项目名称",
  "description": "项目描述"
}
```

### 上传版本

```
POST /api/projects/:id/versions
Content-Type: multipart/form-data

username: 用户名
description: 更新描述
version_type: major|minor|patch
files: 文件列表
```

### 获取版本历史

```
GET /api/projects/:id/versions
```

### 预览版本

```
访问: http://localhost:23359/projects/项目名/v版本号/index.html
```

### 下载版本

```
GET /api/projects/versions/:versionId/download
```

### 回滚版本

```
POST /api/projects/versions/:versionId/rollback
```

## ⚠️ 注意事项

1. **项目名称唯一**: 不能创建同名项目
2. **包含index.html**: 上传的项目必须包含index.html才能预览
3. **版本号自动递增**: 系统会根据选择的类型自动计算新版本号
4. **文件保留**: 删除项目会同时删除所有版本文件
5. **NAS访问**: 确保NAS路径可访问

## 🐛 常见问题

### Q: 上传失败怎么办？

A: 检查：

- 文件大小是否超限
- NAS路径是否可访问
- 网络连接是否正常

### Q: 预览显示404？

A: 检查：

- 项目是否包含index.html
- 文件路径是否正确
- 静态文件服务是否正常

### Q: 版本号不对？

A: 版本号由系统自动计算，基于当前版本和选择的类型：

- major: 主版本+1，次版本和补丁版本归0
- minor: 次版本+1，补丁版本归0
- patch: 补丁版本+1

## 📊 示例

### 创建并上传一个Vue项目

1. **构建Vue项目**

```bash
cd your-vue-project
npm run build
```

2. **上传dist目录**

- 在项目管理页面创建项目
- 点击"上传版本"
- 选择 `dist` 文件夹
- 填写信息并上传

3. **预览**

- 点击"版本历史"
- 点击"预览"按钮
- 在新标签页查看你的Vue应用

## 🎉 完成！

现在你可以：

- ✅ 管理多个前端项目
- ✅ 追踪版本历史
- ✅ 一键预览网页
- ✅ 随时回滚版本
- ✅ 下载历史版本

享受项目管理的便利吧！
